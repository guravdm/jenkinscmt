<!--     <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.0/angular-sanitize.js"></script>
 -->
<div>
<div class="page_cont_padd">
	<div class="page_container">
		<!--heading text-->

		<div class="col-md-12">
			<div class="header_button">
				<!--<button type="button" class="btn btn-primary" id="wdt_re">Litigation Calender</button>-->
				<h2 id="user_header">Sub Task Configuration</h2>
				<!-- <a ng-click="backToPreviousState()"><img
					src="images/DashboardIcons/backold.png" class="backButton"
					width="100px;"></a> -->
				<site-header Back="" forward="forward"></site-header>
			</div>
		</div>

		<div class="div_style"></div>
		<!--first form-->


		<form autocomplete="off" name="taskSearchForm" class="form-horizontal" novalidate>
			<div class="f_form_content">
				<h2>Search</h2>
				<div class="col-md-12">
					<div class="col-md-4">
						<div class="form-group">
							<label class="control-label col-sm-4" for="sel1">Vertical :</label>
							<div class="col-sm-8">
									<select class="form-control" name="orga_id" ng-model="searchObj.orga_id" ng-options="e.orga_id as e.orga_name for e in entityList" ng-change="getEntityDependentArray()" >
									<option value="">--Select--</option>
									</select>
							</div>
						</div>
					</div>
					<div class="col-md-4">
						<div class="form-group">
							<label class="control-label col-sm-4" for="sel1">Unit :</label>
							<div class="col-sm-8">
									<select class="form-control" name="loca_id" ng-model="searchObj.loca_id" ng-options="u.loca_id as u.loca_name for u in unitList" ng-change="getUnitDependentArray()" >
									<option value="">--Select--</option>
									</select>
							</div>
						</div>
					</div>

					<div class="col-md-4">
						<div class="form-group">
							<label class="control-label col-sm-4" for="sel1">Function
								:</label>
							<div class="col-sm-8">
									<select class="form-control" name="dept_id" ng-model="searchObj.dept_id" ng-options="f.dept_id as f.dept_name for f in functionList" ng-change="getFunctionDependentArray()" >
									<option value="">--Select--</option>
									</select>
							</div>
						</div>
					</div>
					
					<div class="col-md-4">
							<div class="form-group">
								<label class="control-label col-sm-4" for="sel1">Executor:</label>
								<div class="col-sm-8">
									<select class="form-control" name="exec_id"
										ng-model="searchObj.executor_id"
										ng-options="ex.user_id as ex.user_name for ex in executorList">
										<option value="">--Select--</option>
									</select>
								</div>
							</div>
						</div>

						<div class="col-md-4">
							<div class="form-group">
								<label class="control-label col-sm-4" for="sel1">Evaluator:</label>
								<div class="col-sm-8">
									<select class="form-control" name="exec_id"
										ng-model="searchObj.evaluator_id"
										ng-options="ev.user_id as ev.user_name for ev in evaluatorList">
										<option value="">--Select--</option>
									</select>
								</div>
							</div>
						</div>
						<div class="col-md-4">
								<div class="form-group">
									<label class="control-label col-sm-4" for="sel1">Frequency :</label>
									<div class="col-sm-8">
										<select class="form-control" name="equip_Freq"
											ng-model="searchObj.equip_Freq"
											ng-options="f.equip_Freq as f.equip_Freq for f in equipmentFrequencyList"
											ng-change="getFunctionDependentArray()" required>
											<option value="">--Select--</option>
										</select>
									</div>
								</div>
							</div>
<br>
				<div class="col-md-12">
					<div class="form-group">
							<label class="control-label col-sm-4" for="sel1">Legislation
								:</label>
							<div class="col-sm-8">
									<ui-select ng-model="legiList.selected" theme="bootstrap"
										style="max-width: 545px;" ng-change="getalllegiRuleList();getEventSubEvent()"> 
										<ui-select-match placeholder="Select legislation">{{$select.selected.task_legi_name}}
										<button class="clear" ng-click="clearLegiList($event)">X</button>
										</ui-select-match>
									<ui-select-choices
										repeat="legiList in alllegiList | propsFilter: {task_legi_name: $select.search}">

									<div
										ng-bind-html="legiList.task_legi_name | highlight: $select.search"></div>
<!-- 									{{legiList.task_legi_name}}  -->
									</ui-select-choices> </ui-select>
							</div>
						</div>
				</div>
				
				<div class="col-md-12">
					<div class="form-group">
							<label class="control-label col-sm-4" for="sel1">Rule
								:</label>
							<div class="col-sm-8">
									<ui-select ng-model="legiRuleL.selected" ng-change="getEventSubEvent()" theme="bootstrap"  style="max-width: 545px;">
								    <ui-select-match placeholder="Select rules">
								     <button class="clear" ng-click="clearLegiRuleL($event)">X</button>
								    {{$select.selected.task_rule_name}}</ui-select-match>
								    <ui-select-choices repeat="legiRuleL in legiRuleList | propsFilter: {task_rule_name: $select.search}">
								     
								      <div ng-bind-html="legiRuleL.task_rule_name | highlight: $select.search"></div>
<!-- 								      {{legiRuleL.task_rule_name}} -->
								    </ui-select-choices>
								  </ui-select>
							</div>
						</div>
				</div>
				
				<div class="col-md-12">
							<div class="col-md-4">
								<div class="form-group">
									<label class="control-label col-sm-4" for="sel1">Compliance Title:</label>
									<div class="col-sm-8">
										<select class="form-control" name="equip_type"
											ng-model="searchObj.equip_type"
											ng-options="e.equip_type as e.equip_type for e in equipmentTypeList"
											ng-change="getEquipmentTypeDependent()">
											<option value="">--Select--</option>
										</select>
									</div>
								</div>
							</div>

							<div class="col-md-4">
								<div class="form-group">
									<label class="control-label col-sm-4" for="sel1">Name Of Contractor :</label>
									<div class="col-sm-8">
										<select class="form-control" name="equip_number"
											ng-model="searchObj.equip_number"
											ng-options="f.equip_number as f.equip_number for f in equipmentNumberList"
											ng-change="getEquipmentNumberDependent()">
											<option value="">--Select--</option>
										</select>
									</div>
								</div>
							</div>

							<div class="col-md-4">
								<div class="form-group">
									<label class="control-label col-sm-4" for="sel1">Unit :</label>
									<div class="col-sm-8">
										<select class="form-control" name="equip_loca"
											ng-model="searchObj.equip_loca"
											ng-options="f.equip_loca as f.equip_loca for f in equipmentUnitList"
											ng-change="getEquipmentLocationDependent()">
											<option value="">--Select--</option>
										</select>
									</div>
								</div>
							</div>

							
						</div>
								
				</div>
				
				<div class="col-md-12 litigation_buttons">
					<br>
					<center>
					<div id="search">
						<button type="submit" id="assign" ng-click="searchSubTasks()"  class="btn btn-myPrimary btn-save">Search</button>
					</div>
					</center>
				</div>
			</div>
		</form>
  
	<div class="row"  ng-if="tmapObj.tasks_list.length>0"> <!-- ng-if="tmapObj.tasks_list.length>0" -->
			<div class="col-md-10" >
				<form autocomplete="off" name="configForm" class="form-horizontal" novalidate>
					<table id="example1" class="table"
						width="90%" cellspacing="0">
						<thead>
							<tr style="background: #0B6EC3; color: #fff;">
								<th>#</th>
								<th>Document / Historical</th>
								<th>Back Dates</th>
								<th>Buffer Days</th>
								<th>Task Maker Checker</th>
							</tr>
						</thead>
						<tbody id="multiConfig">
						   <tr >
								<td><strong>1)</strong></td>
								
								<td><div class="form-group">
										<div style="padding: 0px; width: 100%;" class="col-sm-12">
											<label for="sel1" style="margin-left: 13px;" class="control-label">Doc. :</label> <label class="radio-inline"><input type="radio" ng-model="tmapObj.ttrn_document" value="1" name="optradio">Yes</label> <label class="radio-inline"><input type="radio" ng-model="tmapObj.ttrn_document" value="0" name="optradio">No</label>
										</div>
									</div>
									<div style="clear: both;"></div>
									<div class="form-group">
										<div style="padding: 0px; width: 100%;" class="col-sm-12">
											<label for="sel1" style="margin-left: 13px;" class="control-label">Hist. :</label> <label class="radio-inline"><input type="radio" value="1" ng-model="tmapObj.ttrn_historical" name="optradio1">Yes</label> <label class="radio-inline"><input type="radio" ng-model="tmapObj.ttrn_historical" value="0" name="optradio1">No</label>
										</div>
									</div>
								</td>
								
								<td><input type="radio" ng-model="tmapObj.ttrn_allow_back_date_completion" value="1" />&nbsp;&nbsp;Allowed 
							    <p ng-show="tmapObj.ttrn_allow_back_date_completion == 1">
								   <input type="text" min="1" style="width:50px;"  ng-required="tmapObj.ttrn_allow_back_date_completion == 1" placeholder="Days" name="back_date_allowed"  ng-model="tmapObj.ttrn_no_of_back_days_allowed"  />
								  <div ng-messages="configForm.back_date_allowed.$error" ng-if="tmapObj.ttrn_allow_back_date_completion == 1">
								      <span class="error-text" ng-message="required">Enter days.</span>
							       </div> 
							        <p class="error-text">{{errMessage.back_date}}</p>  
								</p> <br/> 
								<input type="radio"  ng-model="tmapObj.ttrn_allow_back_date_completion" value="0" />&nbsp;&nbsp; Not Allowed</td>
								
								<td class="hideForUserDefinedFrequency" ng-show="tmapObj.ttrn_frequency_for_operation != 'User_Defined' && tmapObj.ttrn_frequency_for_operation != 'Event_Based'">
								<div class="form-group">
									<!-- <label class="control-label col-sm-4" for="">Due Date
										Buffer:</label> -->
									<div class="col-sm-8">
										<input class="form-control" ng-change="getDates();validateDates();" ng-model="tmapObj.ttrn_prior_days_buffer" type="text">
									</div>
								</div>
							</td>

							<td>
						      <input ng-model="tmapObj.ttrn_allow_approver_reopening" value="1" type="radio">&nbsp;&nbsp; Allowed &nbsp;
							  <input ng-model="tmapObj.ttrn_allow_approver_reopening" value="0" type="radio">&nbsp;&nbsp;Not Allowed
							</td>

							</tr>
						
						
						</tbody>
					</table>
					
					
					<table id="example3" ng-show="tmapObj.ttrn_frequency_for_operation != 'User_Defined' && tmapObj.ttrn_frequency_for_operation != 'Event_Based'" class="table table-striped table-bordered"	width="90%" cellspacing="0" >
						<tr style="background: #0B6EC3; color: #fff;">
							<th>#</th>
							<th>Legal Due Date</th>
							<th>Unit Head Due Date</th>
							<th>Function Head Due Date</th>
							<th>Evaluator Due Date</th>
							<th>Executor Due Date</th>
						</tr>
						<tbody>
							<tr>
								<td><strong>2)</strong></td>
									<td>
										<div flex-gt-xs>
											<md-datepicker name="legal_date" ng-model="tmapObj.ttrn_legal_due_date" ng-change="getDates();validateDates();"
												md-placeholder="Enter date" required></md-datepicker>
										</div>
										<div ng-messages="configForm.legal_date.$error" ng-if="configForm.$submitted">
								          <span class="error-text" ng-message="required">Select date. </span> 
							            </div> 
							            <p class="error-text">{{errMessage.lh_date}}</p>
									</td>
									<td>
										<div flex-gt-xs>
											<md-datepicker name="unit_date" ng-model="tmapObj.ttrn_uh_due_date" ng-change="validateDates();"
												md-placeholder="Enter date" required></md-datepicker>
										</div>
										<div ng-messages="configForm.unit_date.$error" ng-if="configForm.$submitted">
								          <span class="error-text" ng-message="required">Select date.</span>
							            </div> 
							            <p class="error-text">{{errMessage.uh_date}}</p>
									</td>
									<td>
										<div flex-gt-xs>
											<md-datepicker name="function_date" ng-model="tmapObj.ttrn_fh_due_date" ng-change="validateDates();"
												md-placeholder="Enter date" required></md-datepicker>
										</div>
										<div ng-messages="configForm.function_date.$error" ng-if="configForm.$submitted">
								          <span class="error-text" ng-message="required">Select date.</span>
							            </div>
							            <p class="error-text">{{errMessage.fh_date}}</p>
									</td>
									<td>
										<div flex-gt-xs>
											<md-datepicker name="rw_date" ng-model="tmapObj.ttrn_rw_due_date" ng-change="validateDates();"
												md-placeholder="Enter date" required></md-datepicker>
										</div>
										<div ng-messages="configForm.rw_date.$error" ng-if="configForm.$submitted">
								          <span class="error-text" ng-message="required">Select date.</span>
							            </div>
							            <p class="error-text">{{errMessage.rw_date}}</p>
									</td>
									<td>
									<div flex-gt-xs>
											<md-datepicker name="pr_date" ng-model="tmapObj.ttrn_pr_due_date" ng-change="validateDates();"
												md-placeholder="Enter date" required></md-datepicker>
									 </div>
									 <div ng-messages="configForm.pr_date.$error" ng-if="configForm.$submitted">
								          <span class="error-text" ng-message="required">Select date.</span>
							         </div>
							            <p class="error-text">{{errMessage.pr_date}}</p>
								</td>
							</tr>
						</tbody>
					</table>
					<table class="table table-striped table-bordered" ng-show="tmapObj.ttrn_frequency_for_operation != 'User_Defined' && tmapObj.ttrn_frequency_for_operation != 'Event_Based'"  width="90%"
						cellspacing="0">
						<tr style="background: #0B6EC3; color: #fff;">
							<th>Extra Alerts</th>
							
						</tr>
						<tr>
							<td><input type="checkbox" ng-model="extra_alert" ng-click="checkStatus(extra_alert)" name="extraAlerts" />&nbsp;<em>(Note: Check here for Extra alerts)</em></td>
						</tr>
					</table>
					<table ng-show="extra_alert" class="table table-striped table-bordered" width="90%"	cellspacing="0">
						<tr style="background: #0B6EC3; color: #fff;">
							<th><strong>#</strong></th>
							<th colspan="2">First Alert</th>
							<th colspan="2">Second Alert</th>
							<th colspan="2">Third Alert</th>
						</tr>
						<tr>
							<td><strong>2)</strong></td> 
							<td class="ExtraAlerts" colspan="2">
							  <md-datepicker ng-model="tmapObj.ttrn_first_alert"	md-placeholder="Enter date"></md-datepicker>
							  <p class="error-text">{{errMessage.fa_date}}</p>
							</td>
							<td class="ExtraAlerts" colspan="2">
								<md-datepicker ng-model="tmapObj.ttrn_second_alert"	md-placeholder="Enter date"></md-datepicker>
								<p class="error-text">{{errMessage.sa_date}}</p>
							</td>	
							<td class="ExtraAlerts" colspan="2">
							    <md-datepicker ng-model="tmapObj.ttrn_third_alert"	md-placeholder="Enter date"></md-datepicker>
							    <p class="error-text">{{errMessage.ta_date}}</p>
							</td>
						</tr>
						</tbody>
					</table>
					<table class="table table-striped table-bordered" width="90%"
						cellspacing="0">
						<tr>
						    <td style="display:none;">
						      <input type="text" class="form-control" name="validate_dates" ng-model="tmapObj.validate_dates"/>
								   <div ng-messages="configForm.validate_dates.$error" ng-if="configForm.$submitted">
								      <span class="error-text" ng-message="required">Check Date validation.</span>
							       </div>
						    </td> 
							<td colspan="8" >
								<div class="col-md-12 litigation_buttons divSubmit">
									<br> <input type="submit" class="btn btn-myPrimary" ng-click ="saveConfiguration(configForm.$valid);" value="Save Configuration">
								</div>
							</td>
						</tr>
					</table>
				</form>
			</div>
		</div>

  <!-- end of second form -->



			<form autocomplete="off" name="assignTaskForm" class="form-horizontal" novalidate>
			<div class="div_style"></div>
			<br>

			<div class="table_data1">
				<div class="container">
					<div class="col-sm-6">
					<div class="col-sm-4">
						<label class="control-label" for=""> <input type="checkbox" name="selectall" id="selectAll" ng-model="selectedAll" ng-click="checkAll()">Select
							All
						</label>
						</div>
						<div class="col-sm-4">
							<label class="control-label " for="">Total Task : {{taskList.length}}</label> <label
								class="control-label lblcount" for="totaltask"></label>
						</div>
						<div class="col-sm-4">
							<label class="control-label" for="">Selected Task : {{tmapObj.tasks_list.length}}</label> <label
								class="control-label lblcount" for="selectedtask"></label>
						</div>
					</div>
					<table id="example" class="table table-striped table-bordered"
						width="100%" cellspacing="0">
						<thead>
							<tr id="table_row">
								<th>Sub Task ID</th>
								<th>Client Task ID</th>
								<th>Compliance Title</th>
								<th>Name Of Contractor</th>
								<th>Compliance Activity</th>
								<th>Unit</th>
								<!-- <th>Last Examination Date</th> -->
								<th>Frequency</th>
							</tr>
						</thead>

						<tbody id="task_table_body">
							 <tr ng-repeat="list in taskList" ng-if="taskList.length>0">
								<td><center><input type="checkbox" value="list.task_id" ng-model="list.SelectedTaskId" ng-click="getCheckTaskId(list.SelectedTaskId,list.sub_client_task_id,list.sub_task_id)" ></center>{{list.sub_task_id}}</td>
								<td><br>{{list.sub_client_task_id}}</td>
								<td>{{list.sub_equip_type}}</td>
								<td>{{list.sub_equip_number}}</td>
								<td>{{list.sub_equip_descri}}</td>
								<td>{{list.sub_equip_location}}</td>
								<!-- <td>{{list.sub_equip_last_examination_date}}</td> -->
								<td>{{list.sub_equip_frequency}}</td>
							</tr>
							<tr ng-if="taskList.length==0"><td colspan="12"><center> No record found</center></td></tr>
							 
						</tbody>
					</table>
				</div>
			</div>
		</form>
	</div>
</div>
</div>
